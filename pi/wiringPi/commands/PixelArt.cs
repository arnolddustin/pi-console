using System.Collections.Generic;
using System;
using System.Text;

namespace pi.wiringPi.commands
{
    public class PixelArt
    {
        Dictionary<char, byte[]> _chars;

        public PixelArt()
        {
            _chars = new Dictionary<char, byte[]>();

            InitializeCharacters();
        }

        public char[] SupportedCharacters()
        {
            var list = new List<char>();

            foreach (var key in _chars.Keys)
                list.Add(key);

            return list.ToArray();
        }

        public byte[] Get(params char[] letters)
        {
            var list = new List<byte>();

            foreach (var letter in letters)
                list.AddRange(_chars[letter]);

            return list.ToArray();
        }

        public byte[] Get(string str)
        {
            var list = new List<byte>();

            foreach (var letter in str)
                list.AddRange(_chars[letter]);

            return list.ToArray();
        }

        byte[] RotateRecursive(byte[] rows, int remaining)
        {
            if (remaining == 0)
                return rows;

            var cols = new List<string>();
            for (var i = 0; i < 8; i++)
                cols.Add("");

            foreach (var row in rows)
            {
                var bits = Convert.ToString(row, 2).PadLeft(8, '0');
                for (var i = 0; i < 8; i++)
                    cols[i] += bits[i];
            }

            var newRows = new List<byte>();
            foreach (var col in cols)
                newRows.Add(Convert.ToByte(col, 2));

            newRows.Reverse();

            return RotateRecursive(newRows.ToArray(), remaining - 1);
        }

        void InitializeCharacters()
        {
            addChar(' ',
                0b00000000,
                0b00000000,
                0b00000000,
                0b00000000,
                0b00000000,
                0b00000000,
                0b00000000,
                0b00000000);
            addChar('A',
                0b00000000,
                0b00011000,
                0b00100100,
                0b00100100,
                0b00111100,
                0b00100100,
                0b00000000,
                0b00000000);
            addChar('a',
                0b00000000,
                0b00000000,
                0b00011100,
                0b00100100,
                0b00100100,
                0b00011100,
                0b00000000,
                0b00000000);
            addChar('B',
                0b00000000,
                0b00111000,
                0b00100100,
                0b00111000,
                0b00100100,
                0b00111000,
                0b00000000,
                0b00000000);
            addChar('b',
                0b00000000,
                0b00100000,
                0b00111000,
                0b00100100,
                0b00100100,
                0b00111000,
                0b00000000,
                0b00000000);
            addChar('C',
                0b00000000,
                0b00011000,
                0b00100000,
                0b00100000,
                0b00100000,
                0b00011000,
                0b00000000,
                0b00000000);
            addChar('c',
                0b00000000,
                0b00000000,
                0b00011000,
                0b00100000,
                0b00100000,
                0b00011000,
                0b00000000,
                0b00000000);
            addChar('D',
                0b00000000,
                0b00111000,
                0b00100100,
                0b00100100,
                0b00100100,
                0b00111000,
                0b00000000,
                0b00000000);
            addChar('d',
                0b00000000,
                0b00000100,
                0b00011100,
                0b00100100,
                0b00100100,
                0b00011100,
                0b00000000,
                0b00000000);
            addChar('E',
                0b00000000,
                0b00111000,
                0b00100000,
                0b00111000,
                0b00100000,
                0b00111000,
                0b00000000,
                0b00000000);
            addChar('e',
                0b00000000,
                0b00000000,
                0b00011000,
                0b00101100,
                0b00110000,
                0b00011000,
                0b00000000,
                0b00000000);
            addChar('F',
                0b00000000,
                0b00111000,
                0b00100000,
                0b00111000,
                0b00100000,
                0b00100000,
                0b00000000,
                0b00000000);
            addChar('f',
                0b00000000,
                0b00001000,
                0b00010000,
                0b00111000,
                0b00010000,
                0b00010000,
                0b00000000,
                0b00000000);
            addChar('G',
                0b00000000,
                0b00011100,
                0b00100000,
                0b00101100,
                0b00100100,
                0b00011100,
                0b00000000,
                0b00000000);
            addChar('g',
                0b00000000,
                0b00000000,
                0b00011100,
                0b00100100,
                0b00100100,
                0b00011100,
                0b00000100,
                0b00011000);
            addChar('H',
                0b00000000,
                0b00100100,
                0b00100100,
                0b00111100,
                0b00100100,
                0b00100100,
                0b00000000,
                0b00000000);
            addChar('h',
                0b00000000,
                0b00100000,
                0b00111000,
                0b00100100,
                0b00100100,
                0b00100100,
                0b00000000,
                0b00000000);
            addChar('I',
                0b00000000,
                0b00111000,
                0b00010000,
                0b00010000,
                0b00010000,
                0b00111000,
                0b00000000,
                0b00000000);
            addChar('i',
                0b00000000,
                0b00100000,
                0b00000000,
                0b00100000,
                0b00100000,
                0b00100000,
                0b00000000,
                0b00000000);
            addChar('J',
                0b00000000,
                0b00001100,
                0b00000100,
                0b00000100,
                0b00100100,
                0b00011000,
                0b00000000,
                0b00000000);
            addChar('j',
                0b00000000,
                0b00000100,
                0b00000000,
                0b00000100,
                0b00000100,
                0b00000100,
                0b00001000,
                0b00000000);
            addChar('K',
                0b00000000,
                0b00100100,
                0b00101000,
                0b00110000,
                0b00101000,
                0b00100100,
                0b00000000,
                0b00000000);
            addChar('k',
                0b00000000,
                0b00100000,
                0b00100100,
                0b00101000,
                0b00111000,
                0b00100100,
                0b00000000,
                0b00000000);
            addChar('L',
                0b00000000,
                0b00100000,
                0b00100000,
                0b00100000,
                0b00100000,
                0b00111100,
                0b00000000,
                0b00000000);
            addChar('l',
                0b00000000,
                0b00110000,
                0b00010000,
                0b00010000,
                0b00010000,
                0b00010000,
                0b00000000,
                0b00000000);
            addChar('M',
                0b00000000,
                0b00100010,
                0b00110110,
                0b00101010,
                0b00100010,
                0b00100010,
                0b00000000,
                0b00000000);
            addChar('m',
                0b00000000,
                0b00000000,
                0b00111100,
                0b00101010,
                0b00101010,
                0b00101010,
                0b00000000,
                0b00000000);
            addChar('N',
                0b00000000,
                0b00100100,
                0b00110100,
                0b00101100,
                0b00100100,
                0b00100100,
                0b00000000,
                0b00000000);
            addChar('n',
                0b00000000,
                0b00000000,
                0b00111000,
                0b00100100,
                0b00100100,
                0b00100100,
                0b00000000,
                0b00000000);
            addChar('O',
                0b00000000,
                0b00011000,
                0b00100100,
                0b00100100,
                0b00100100,
                0b00011000,
                0b00000000,
                0b00000000);
            addChar('o',
                0b00000000,
                0b00000000,
                0b00011000,
                0b00100100,
                0b00100100,
                0b00011000,
                0b00000000,
                0b00000000);
            addChar('P',
                0b00000000,
                0b00111000,
                0b00100100,
                0b00111000,
                0b00100000,
                0b00100000,
                0b00000000,
                0b00000000);
            addChar('p',
                0b00000000,
                0b00000000,
                0b00111000,
                0b00100100,
                0b00111000,
                0b00100000,
                0b00100000,
                0b00000000);
            addChar('Q',
                0b00000000,
                0b00011000,
                0b00100100,
                0b00100100,
                0b00100100,
                0b00011000,
                0b00000100,
                0b00000000);
            addChar('q',
                0b00000000,
                0b00000000,
                0b00011100,
                0b00100100,
                0b00011100,
                0b00000100,
                0b00000100,
                0b00000000);
            addChar('R',
                0b00000000,
                0b00111000,
                0b00100100,
                0b00100100,
                0b00111000,
                0b00100100,
                0b00000000,
                0b00000000);
            addChar('r',
                0b00000000,
                0b00000000,
                0b00101000,
                0b00110000,
                0b00100000,
                0b00100000,
                0b00000000,
                0b00000000);
            addChar('S',
                0b00000000,
                0b00011100,
                0b00100000,
                0b00011000,
                0b00000100,
                0b00111000,
                0b00000000,
                0b00000000);
            addChar('s',
                0b00000000,
                0b00000000,
                0b00011100,
                0b00110000,
                0b00001100,
                0b00111000,
                0b00000000,
                0b00000000);
            addChar('T',
                0b00000000,
                0b00111000,
                0b00010000,
                0b00010000,
                0b00010000,
                0b00010000,
                0b00000000,
                0b00000000);
            addChar('t',
                0b00000000,
                0b00010000,
                0b00111000,
                0b00010000,
                0b00010000,
                0b00001000,
                0b00000000,
                0b00000000);
            addChar('U',
                0b00000000,
                0b00100100,
                0b00100100,
                0b00100100,
                0b00100100,
                0b00011000,
                0b00000000,
                0b00000000);
            addChar('u',
                0b00000000,
                0b00000000,
                0b00100100,
                0b00100100,
                0b00100100,
                0b00011100,
                0b00000000,
                0b00000000);
            addChar('V',
                0b00000000,
                0b00100100,
                0b00100100,
                0b00101000,
                0b00101000,
                0b00010000,
                0b00000000,
                0b00000000);
            addChar('v',
                0b00000000,
                0b00000000,
                0b00100100,
                0b00100100,
                0b00101000,
                0b00010000,
                0b00000000,
                0b00000000);
            addChar('W',
                0b00000000,
                0b00100010,
                0b00101010,
                0b00101010,
                0b00101010,
                0b00010100,
                0b00000000,
                0b00000000);
            addChar('w',
                0b00000000,
                0b00000000,
                0b00101010,
                0b00101010,
                0b00010100,
                0b00010100,
                0b00000000,
                0b00000000);
            addChar('X',
                0b00000000,
                0b00100100,
                0b00100100,
                0b00011000,
                0b00100100,
                0b00100100,
                0b00000000,
                0b00000000);
            addChar('x',
                0b00000000,
                0b00000000,
                0b00101000,
                0b00010000,
                0b00010000,
                0b00101000,
                0b00000000,
                0b00000000);
            addChar('Y',
                0b00000000,
                0b00100100,
                0b00100100,
                0b00011100,
                0b00000100,
                0b00011000,
                0b00000000,
                0b00000000);
            addChar('y',
                0b00000000,
                0b00000000,
                0b00100100,
                0b00100100,
                0b00100100,
                0b00011100,
                0b00000100,
                0b00011000);
            addChar('Z',
                0b00000000,
                0b00111000,
                0b00001000,
                0b00010000,
                0b00100000,
                0b00111000,
                0b00000000,
                0b00000000);
            addChar('z',
                0b00000000,
                0b00000000,
                0b00111100,
                0b00001000,
                0b00010000,
                0b00111100,
                0b00000000,
                0b00000000);
            addChar('1',
                0b00000000,
                0b00010000,
                0b00110000,
                0b00010000,
                0b00010000,
                0b00111000,
                0b00000000,
                0b00000000);
            addChar('2',
                0b00000000,
                0b00111000,
                0b00000100,
                0b00011000,
                0b00100000,
                0b00111100,
                0b00000000,
                0b00000000);
            addChar('3',
                0b00000000,
                0b00111000,
                0b00000100,
                0b00011000,
                0b00000100,
                0b00111000,
                0b00000000,
                0b00000000);
            addChar('4',
                0b00000000,
                0b00001000,
                0b00011000,
                0b00101000,
                0b00111100,
                0b00001000,
                0b00000000,
                0b00000000);
            addChar('5',
                0b00000000,
                0b00111100,
                0b00100000,
                0b00111000,
                0b00000100,
                0b00111000,
                0b00000000,
                0b00000000);
            addChar('6',
                0b00000000,
                0b00011000,
                0b00100000,
                0b00111000,
                0b00100100,
                0b00011000,
                0b00000000,
                0b00000000);
            addChar('7',
                0b00000000,
                0b00111100,
                0b00000100,
                0b00001000,
                0b00010000,
                0b00010000,
                0b00000000,
                0b00000000);
            addChar('8',
                0b00000000,
                0b00011000,
                0b00100100,
                0b00011000,
                0b00100100,
                0b00011000,
                0b00000000,
                0b00000000);
            addChar('9',
                0b00000000,
                0b00011000,
                0b00100100,
                0b00011100,
                0b00000100,
                0b00011000,
                0b00000000,
                0b00000000);
            addChar('0',
                0b00000000,
                0b00011000,
                0b00100100,
                0b00100100,
                0b00100100,
                0b00011000,
                0b00000000,
                0b00000000);
            addChar('!',
                0b00000000,
                0b00100000,
                0b00100000,
                0b00100000,
                0b00000000,
                0b00100000,
                0b00000000,
                0b00000000);
            addChar('?',
                0b00000000,
                0b00111000,
                0b00000100,
                0b00011000,
                0b00000000,
                0b00010000,
                0b00000000,
                0b00000000);
            addChar(',',
                0b00000000,
                0b00000000,
                0b00000000,
                0b00000000,
                0b00000000,
                0b00010000,
                0b00100000,
                0b00000000);
            addChar('.',
                0b00000000,
                0b00000000,
                0b00000000,
                0b00000000,
                0b00000000,
                0b00100000,
                0b00000000,
                0b00000000);
            addChar('<',
                0b00000000,
                0b00001000,
                0b00010000,
                0b00100000,
                0b00010000,
                0b00001000,
                0b00000000,
                0b00000000);
            addChar('>',
                0b00000000,
                0b00100000,
                0b00010000,
                0b00001000,
                0b00010000,
                0b00100000,
                0b00000000,
                0b00000000);
        }

        void addChar(char key, params byte[] rows)
        {
            _chars.Add(key, RotateRecursive(rows, 3));
        }
    }
}